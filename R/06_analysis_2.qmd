---
title: "06_analysis_2"
format: html
editor: visual
---

### Download data

```{r}
placental_gene_expr_log2_fold <- read_tsv("../data/03_dat_augment_log2_fold.tsv")
```

### Loading libraries

```{r}
library(dplyr)
library(ggplot2)
```

```{r}
# Count how many p-values are under 0.05 and thereby significantly different
significant_genes_count <- placental_gene_expr_log2_fold |>
  filter(p_value < 0.05) |>
  summarise(count = n())

print(significant_genes_count)
```

```{r}
ggplot(placental_gene_expr_log2_fold, aes(x = log2_fold_change, y = -log10(p_value))) +
  geom_point() +
  geom_hline(yintercept = -log10(0.05), linetype = "dashed", color = "#F9A1A1") +
  labs(x = "Log2 Fold Change", y = "-log10(p-value)", title = "Volcano Plot")
```

### Plot of up- and downregulated genes in smokers

```{r}
ggplot(placental_gene_expr_log2_fold, aes(x = reorder(gene, log2_fold_change), y = log2_fold_change, fill = Regulation)) +
  geom_bar(stat = "identity", width = 0.8) + 
  coord_flip() +  # Flip coordinates so the plot is more interpretable 
  scale_fill_manual(values = c("Upregulated" = "#63B8B8", "Downregulated" = "#F9A1A1")) +
  labs(title = "Upregulated vs. Downregulated Genes in Smokers",
       x = "Genes",
       y = "Log2-Fold Change") +
  theme_minimal() +
  theme(axis.text.y = element_blank(),  # Removing y-axis gene labels
        plot.title = element_text(hjust = 0.5))

ggsave("../results/plots/upregulated_downregulated_genes.png")
```
