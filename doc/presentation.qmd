---
title: "The Effect of Maternal Tobacco Smoke Exposure on the Placental Transcriptome"
author: |
  Anna Rasmussen  
  Ida Meyer-Kristensen  
  Mathilde Stenholt  
  Nicoline Hansen  
  Ulrikke Furland  
format: 
  revealjs:
    self-contained: true
    code-line-numbers: true
    smaller: true
    scroll: true
    theme: moon
    transition: slide
editor: visual
---

```{r}
library("tidyverse")
library("readr")
library("broom")
library("here")
library("ggrepel")
source("../R/99_proj_func.R")
```

## Study description
This study is about....

<!--# ---------------------------------------------------------------------- -->
<!--# SLIDE ---------------------------------------------------------------- -->
<!--# ---------------------------------------------------------------------- -->

## Data cleaning and wrangling

::: panel-tabset
### Dirty data

```{r}
#| echo: true
ncbi_data <- read_tsv(here("data/01_ncbi_data.tsv.gz"))  # Read and display the gzipped TSV file
print(head(ncbi_data, 10))  # Print the first 10 rows to display
```

### Characteristics data

```{r}
#| echo: true
characteristics_data <- read_tsv(here("data/02_dat_clean_characteristics.tsv"))  # Read characteristics data
print(head(characteristics_data, 10))  # Print the first 10 rows to display
```

### Genes data

```{r}
#| echo: true
genes_data <- read_tsv(here("data/02_dat_clean_genes.tsv"))  # Read gene data
print(head(genes_data, 10))  # Print the first 10 rows to display
```

### Clean Merged data
```{r}
#| echo: true
clean_data <- read_tsv(here("data/02_dat_clean.tsv"))  # Read clean merged data
print(head(clean_data, 10))  # Print the first 10 rows to display
```

:::

<!--# ---------------------------------------------------------------------- -->
<!--# SLIDE ---------------------------------------------------------------- -->
<!--# ---------------------------------------------------------------------- -->
## Description of data
:::: {.columns}

::: {.column width="70%"}
![](../results/plots/description_combined_plot1.png){width=80%}
:::

::: {.column width="30%"}
:::

::::


<!--# ---------------------------------------------------------------------- -->
<!--# SLIDE ---------------------------------------------------------------- -->
<!--# ---------------------------------------------------------------------- -->
## Analysis of data

:::: {.columns style="margin-left: 0px;"}

::: {.column style="margin-left: 0px; width: 40%;"}
```{r}
#| echo: true
#| eval: false
#| results: hide
#| code-line-numbers: "2-7|9-13"
# Extract genedata from merged_data
gene_cols <- grep("^ilmn",
                  names(merged_data),
                  value = TRUE)

merged_log2_fold <- merged_data |>
  group_by(status) |> 
  # Calculate the mean value for expression levels, for each gene, divided into smoker and non-smoker
  summarise(across(all_of(gene_cols),
                   mean, na.rm = TRUE)) |> 
  pivot_longer(cols = -status,
               names_to = "gene",
               values_to = "mean_expr") |> 
  pivot_wider(names_from = status, 
  # Calculate the log2_fold_change for each gene             
              values_from = mean_expr) |> 
  mutate(log2_fold_change = log2(`smoker` / `non-smoker`))
 
p_values <- merged_data |>
  pivot_longer(cols = all_of(gene_cols),
               names_to = "gene",
               values_to = "expression") |>
  # Calculate the p-value for each gene 
  group_by(gene) |> 
  summarise(p_value = t.test(expression ~ status)$p.value)
```
:::



::: {.column width="60%"}
![](../results/plots/upregulated_downregulated_genes.png){width=150%}
:::

::::



<!--# ---------------------------------------------------------------------- -->
<!--# SLIDE ---------------------------------------------------------------- -->
<!--# ---------------------------------------------------------------------- -->
## Analysis of data

:::: {.columns}
- Bulletpoints 
::: {.column width="40%"}
Venstre
:::

::: {.column width="60%"}
![](../results/plots/XXX.png){width=100%}
:::

::::


<!--# ---------------------------------------------------------------------- -->
<!--# SLIDE ---------------------------------------------------------------- -->
<!--# ---------------------------------------------------------------------- -->
## Analysis of data

:::: {.columns}

::: {.column width="40%"}
Venstre
:::

::: {.column width="60%"}
Højre
:::

::::



<!--# ---------------------------------------------------------------------- -->
<!--# SLIDE ---------------------------------------------------------------- -->
<!--# ---------------------------------------------------------------------- -->
## Analysis of data
Sætter billede i midten
![](images/advr_map.png){fig-align="center" width=50%}
:::: {.columns}

::: {.column width="40%"}
Venstre
:::

::: {.column width="60%"}
Højre
:::

::::

_Her skrives der i kursiv_


<!--# ---------------------------------------------------------------------- -->
<!--# SLIDE ---------------------------------------------------------------- -->
<!--# ---------------------------------------------------------------------- -->
## Analysis of data

Skriv her for at skrive i midten øverst på sildet 

:::: {.columns}

::: {.column width="40%"}
Venstre
:::

::: {.column width="60%"}
Højre
:::

::::

<!--# ---------------------------------------------------------------------- -->
<!--# SLIDE ---------------------------------------------------------------- -->
<!--# ---------------------------------------------------------------------- -->
## Conclusion  

:::: {.columns}

::: {.column width="40%"}
Venstre
:::

::: {.column width="60%"}
Højre
:::
